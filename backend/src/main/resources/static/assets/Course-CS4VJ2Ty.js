import{_ as $,r as n,a as N,c as G,o as H,d as L,e as p,f as l,w as r,y as K,z as _,A as Y,m as t,i as J,j as f,k as Q,T as E,U as u,K as W,L as X,x as i,V as Z,v as d,B as x,C as ee,F as V,D as le,aT as ae,aU as te,G as oe,H as re,a2 as se,h,aV as ne,g as ue,N as ie,P as k}from"./index-B2T-xuoP.js";import{_ as de}from"./CourseForm-Cx9oXyuO.js";/* empty css                        */import{f as me}from"./course-C-HDut7x.js";import{f as ce}from"./user-D4eBv3A5.js";import{g as pe}from"./term-BB3--eF6.js";import"./common-Dmk-JHZR.js";import"./request-CvcqSNCl.js";const fe={class:"course-management"},ge={class:"header"},ve={class:"dialog-footer"},ye={name:"CourseManagement"},be=Object.assign(ye,{setup(Ce){const y=n(!1),T=n([]),b=n(0),m=n(1),g=n(10),c=N({keyword:"",status:null,termId:null}),C=n(!1);n("添加课程");const z=n(null),I=n({id:null,courseNo:"",courseName:"",credit:0,courseType:null,collegeId:null,collegeName:"",introduction:"",status:1});N({courseNo:[{required:!0,message:"请输入课程代码",trigger:"blur"}],courseName:[{required:!0,message:"请输入课程名称",trigger:"blur"}],credit:[{required:!0,message:"请输入学分",trigger:"blur"},{type:"number",message:"学分必须为数字值"},{validator:(e,a,s)=>{a<0?s(new Error("学分不能为负数")):s()},trigger:"blur"}]});const w=G(()=>!!I.value.id),U=n([]),F=n([]),v=async()=>{y.value=!0;try{const e={page:m.value,size:g.value,keyword:c.keyword||void 0,status:c.status,termId:c.termId||void 0},a=await me(e);T.value=a.data.records||[],b.value=a.data.total||0}catch(e){console.error("获取课程列表失败",e),k.error("获取课程列表失败")}finally{y.value=!1}},S=async()=>{try{const e=await ce({userType:"Teacher"});U.value=e.data||[]}catch(e){console.error("获取教师列表失败",e)}},B=async()=>{try{const e=await pe();if(e.code===200&&e.data){F.value=e.data;const a=e.data.find(s=>s.current===1);a&&!c.termId&&(c.termId=a.id,v())}else k.error(e.message||"获取学期列表失败")}catch(e){console.error("获取学期列表失败",e),k.error("获取学期列表时发生错误")}},D=e=>{g.value=e,m.value=1,v()},P=e=>{m.value=e,v()};return H(()=>{B(),S()}),(e,a)=>{const s=ee,M=le,A=oe,O=x,R=de,j=re;return p(),L("div",fe,[l(t(ue),{class:"page-container"},{header:r(()=>[h("div",ge,[a[9]||(a[9]=h("span",null,"课程管理",-1)),l(t(i),{icon:t(ne),type:"primary",onClick:e.handleAdd},{default:r(()=>a[8]||(a[8]=[d("添加课程")])),_:1},8,["icon","onClick"])])]),default:r(()=>[l(t(J),{inline:!0,model:e.filters,class:"filter-form"},{default:r(()=>[l(t(f),{label:"课程名称/编号"},{default:r(()=>[l(t(Q),{modelValue:e.filters.keyword,"onUpdate:modelValue":a[0]||(a[0]=o=>e.filters.keyword=o),clearable:"",placeholder:"请输入课程名称或编号"},null,8,["modelValue"])]),_:1}),l(t(f),{label:"课程类型"},{default:r(()=>[l(t(E),{modelValue:e.filters.courseType,"onUpdate:modelValue":a[1]||(a[1]=o=>e.filters.courseType=o),clearable:"",placeholder:"请选择课程类型"},{default:r(()=>[l(t(u),{label:"全部",value:""}),l(t(u),{label:"必修课",value:"COMPULSORY"}),l(t(u),{label:"选修课",value:"ELECTIVE"}),l(t(u),{label:"通识课",value:"GENERAL"})]),_:1},8,["modelValue"])]),_:1}),l(t(f),{label:"所属学院"},{default:r(()=>[l(t(E),{modelValue:e.filters.collegeId,"onUpdate:modelValue":a[2]||(a[2]=o=>e.filters.collegeId=o),clearable:"",filterable:"",placeholder:"请选择学院"},{default:r(()=>[l(t(u),{label:"全部",value:""}),(p(!0),L(W,null,X(e.collegeList,o=>(p(),_(t(u),{key:o.id,label:o.collegeName,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(t(f),{label:"状态"},{default:r(()=>[l(t(E),{modelValue:e.filters.status,"onUpdate:modelValue":a[3]||(a[3]=o=>e.filters.status=o),clearable:"",placeholder:"请选择课程状态"},{default:r(()=>[l(t(u),{label:"全部",value:""}),l(t(u),{label:"启用",value:"1"}),l(t(u),{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),l(t(f),null,{default:r(()=>[l(t(i),{icon:t(Z),type:"primary",onClick:v},{default:r(()=>a[10]||(a[10]=[d("查询")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),K((p(),_(O,{data:T.value,style:{width:"100%"}},{empty:r(()=>[l(A,{description:"暂无课程数据"})]),default:r(()=>[l(s,{label:"课程名称",prop:"courseName","min-width":"180"}),l(s,{label:"课程编号",prop:"courseNo",width:"120"}),l(s,{label:"学分",prop:"credits",width:"80"}),l(s,{label:"课程类型",prop:"courseType",width:"100"},{default:r(o=>[d(V(e.formatCourseType(o.row.courseType)),1)]),_:1}),l(s,{label:"所属学院","min-width":"150",prop:"collegeName"}),l(s,{label:"状态",prop:"status",width:"80"},{default:r(o=>[l(M,{type:o.row.status===1?"success":"danger"},{default:r(()=>[d(V(o.row.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(s,{fixed:"right",label:"操作",width:"150"},{default:r(o=>[l(t(i),{icon:t(ae),circle:"",size:"small",type:"primary",onClick:q=>e.handleEdit(o.row)},null,8,["icon","onClick"]),l(t(i),{icon:t(te),circle:"",size:"small",type:"danger",onClick:q=>e.handleDelete(o.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[j,y.value]]),b.value>0?(p(),_(t(se),{key:0,"current-page":m.value,"onUpdate:currentPage":a[4]||(a[4]=o=>m.value=o),"page-size":g.value,"onUpdate:pageSize":a[5]||(a[5]=o=>g.value=o),"page-sizes":[10,20,50],total:b.value,class:"pagination-container",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:D,onCurrentChange:P},null,8,["current-page","page-size","total"])):Y("",!0)]),_:1}),l(t(ie),{modelValue:C.value,"onUpdate:modelValue":a[7]||(a[7]=o=>C.value=o),"close-on-click-modal":!1,title:w.value?"编辑课程":"添加课程",width:"600px",onClose:e.handleDialogClose},{footer:r(()=>[h("span",ve,[l(t(i),{onClick:a[6]||(a[6]=o=>C.value=!1)},{default:r(()=>a[11]||(a[11]=[d("取消")])),_:1}),l(t(i),{loading:e.submitting,type:"primary",onClick:e.handleSubmit},{default:r(()=>[d(V(w.value?"保存":"创建"),1)]),_:1},8,["loading","onClick"])])]),default:r(()=>[l(R,{ref_key:"courseFormRef",ref:z,"course-data":e.currentCourse,"is-edit":w.value,loading:e.formLoading},null,8,["course-data","is-edit","loading"])]),_:1},8,["modelValue","title","onClose"])])}}}),Le=$(be,[["__scopeId","data-v-4aff97db"]]);export{Le as default};
