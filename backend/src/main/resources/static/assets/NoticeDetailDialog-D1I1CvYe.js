import{_ as T,be as L,r as V,aW as x,d as s,e as o,f as l,k as H,z as $,w as u,y as z,h as _,m as a,H as F,A as h,F as c,v as d,l as v,p as R,bf as S,bg as G,$ as K,J as w,K as P,L as A,M as J,bh as O,G as U,x as W,N as Y,P as D}from"./index-B2T-xuoP.js";import{a as Z}from"./notice-Bm9D3gjc.js";const j={class:"rich-text-editor"},q={__name:"RichTextEditor",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"请输入内容..."},minHeight:{type:Number,default:200}},emits:["update:modelValue"],setup(p,{emit:g}){L(e=>({"1968a46f":`${r.minHeight}px`}));const r=p,k=g,n=V(r.modelValue);return x(()=>r.modelValue,e=>{e!==n.value&&(n.value=e)}),x(n,e=>{k("update:modelValue",e)}),(e,f)=>{const y=H;return o(),s("div",j,[l(y,{modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=B=>n.value=B),placeholder:p.placeholder,rows:p.minHeight/20,type:"textarea"},null,8,["modelValue","placeholder","rows"])])}}},me=T(q,[["__scopeId","data-v-241298a9"]]),Q={key:0,class:"loading-container"},X={key:1,class:"notice-content-wrapper"},ee={class:"notice-title"},te={class:"notice-meta"},ae={key:0},le={key:1},oe={key:2},se={key:3},ne=["innerHTML"],ie={key:0,class:"notice-attachments"},ue={key:2,class:"empty-container"},re={class:"dialog-footer"},ce={__name:"NoticeDetailDialog",props:{modelValue:Boolean,noticeId:{type:[Number,String],default:null}},emits:["update:modelValue"],setup(p,{emit:g}){const r=p,k=g,n=V(!1),e=V(null),f=async()=>{if(!r.noticeId){e.value=null;return}n.value=!0,e.value=null;try{const t=await Z(r.noticeId);t.code===200?e.value=t.data:D.error(t.message||"获取通知详情失败")}catch(t){console.error("获取通知详情失败:",t),D.error("加载通知详情时出错")}finally{n.value=!1}};x(()=>r.noticeId,t=>{r.modelValue&&t&&f()});const y=()=>{k("update:modelValue",!1)},B=t=>{if(!t)return"";try{return new Date(t).toLocaleString("zh-CN",{hour12:!1})}catch{return t}},E={1:"系统通知",2:"院系通知",3:"课程通知",4:"活动通知",default:"其他通知"},M=t=>E[t]||E.default,I=(t,i=2)=>{if(!+t)return"0 Bytes";const m=1024,N=i<0?0:i,C=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],b=Math.floor(Math.log(t)/Math.log(m));return`${parseFloat((t/Math.pow(m,b)).toFixed(N))} ${C[b]}`};return(t,i)=>(o(),$(a(Y),{"before-close":y,"model-value":p.modelValue,class:"notice-detail-dialog",title:"通知详情",top:"5vh",width:"70%",onOpen:f},{footer:u(()=>[_("span",re,[l(a(W),{onClick:y},{default:u(()=>i[2]||(i[2]=[d("关闭")])),_:1})])]),default:u(()=>[n.value?z((o(),s("div",Q,i[0]||(i[0]=[_("p",null,"正在加载通知内容...",-1)]))),[[a(F),n.value]]):e.value?(o(),s("div",X,[_("h3",ee,c(e.value.title),1),_("div",te,[e.value.publisherName?(o(),s("span",ae,[l(a(v),null,{default:u(()=>[l(a(R))]),_:1}),d(" 发布人: "+c(e.value.publisherName),1)])):h("",!0),e.value.publishTime?(o(),s("span",le,[l(a(v),null,{default:u(()=>[l(a(S))]),_:1}),d(" 发布时间: "+c(B(e.value.publishTime)),1)])):h("",!0),e.value.type?(o(),s("span",oe,[l(a(v),null,{default:u(()=>[l(a(G))]),_:1}),d(" 类型: "+c(M(e.value.type)),1)])):h("",!0),e.value.readCount!==void 0?(o(),s("span",se,[l(a(v),null,{default:u(()=>[l(a(K))]),_:1}),d(" 已读: "+c(e.value.readCount),1)])):h("",!0)]),l(a(w)),_("div",{class:"notice-body",innerHTML:e.value.content},null,8,ne),e.value.attachments&&e.value.attachments.length>0?(o(),s("div",ie,[l(a(w),{"content-position":"left"},{default:u(()=>i[1]||(i[1]=[d("附件")])),_:1}),(o(!0),s(P,null,A(e.value.attachments,(m,N)=>(o(),s("div",{key:N,class:"attachment-item"},[l(a(J),{href:m.url,underline:!1,target:"_blank",type:"primary"},{default:u(()=>[l(a(v),null,{default:u(()=>[l(a(O))]),_:1}),d(" "+c(m.name)+" ("+c(I(m.size))+") ",1)]),_:2},1032,["href"])]))),128))])):h("",!0)])):(o(),s("div",ue,[l(a(U),{description:"无法加载通知内容"})]))]),_:1},8,["model-value"]))}},fe=T(ce,[["__scopeId","data-v-a105728d"]]);export{fe as N,me as R};
