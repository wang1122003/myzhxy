import{_ as N,V as j,aK as I,ah as B,R as w,d as K,e as c,h as s,f as o,w as l,x as J,l as L,q as P,k as M,aJ as F,aI as R,K as U,L as q,z as m,E as Y,g as G,F as g,v as r,A as E,D as H,I as O,a2 as Q,u as W,r as u,o as X,P as v,c as Z}from"./index-DrN7HJWs.js";/* empty css               *//* empty css                    */import{g as $,a as ee,c as te,j as ae}from"./activity-hBNT0O0-.js";import"./request-BGbcGZqw.js";const ne={name:"StudentActivities",components:{Calendar:B,Location:I,Search:j},setup(){const S=W(),t=u([]),h=u([]),a=u(""),f=u("all"),_=u(1),C=u(9),p=u(0);X(()=>{i(),d()});const i=()=>{$({page:_.value,pageSize:C.value,keyword:a.value}).then(n=>{t.value=n.data.list,p.value=n.data.total}).catch(()=>{v.error("获取活动列表失败")})},d=()=>{ee().then(n=>{h.value=n.data,t.value.forEach(e=>{h.value.find(A=>A.id===e.id)?e.enrolled=!0:e.enrolled=!1})}).catch(()=>{v.error("获取已报名活动失败")})},y=Z(()=>f.value==="all"?t.value:h.value);return{activities:t,enrolledActivities:h,searchKeyword:a,activeName:f,currentPage:_,pageSize:C,total:p,displayActivities:y,handleSearch:()=>{_.value=1,i()},handleTabClick:()=>{_.value=1,f.value==="all"?i():d()},handleCurrentChange:n=>{_.value=n,f.value==="all"?i():d()},formatDate:n=>{if(!n)return"";const e=new Date(n);return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`},viewActivityDetail:n=>{S.push(`/student/activity/${n}`)},joinActivity:n=>{ae(n).then(()=>{v.success("报名成功"),i(),d()}).catch(()=>{v.error("报名失败")})},cancelJoin:n=>{te(n).then(()=>{v.success("取消报名成功"),i(),d()}).catch(()=>{v.error("取消报名失败")})}}}},oe={class:"activities-container"},le={class:"page-header"},se=["src"],ie={class:"activity-content"},ce={class:"activity-title"},re={class:"activity-time"},de={class:"activity-location"},ue={class:"activity-description"},_e={class:"activity-footer"},pe={class:"activity-actions"},me={class:"pagination-container"};function ve(S,t,h,a,f,_){const C=w("Search"),p=L,i=J,d=M,y=F,b=R,D=w("Calendar"),T=w("Location"),k=H,V=G,x=Y,z=O,n=Q;return c(),K("div",oe,[s("div",le,[t[2]||(t[2]=s("h2",null,"校园活动",-1)),s("div",null,[o(d,{modelValue:a.searchKeyword,"onUpdate:modelValue":t[0]||(t[0]=e=>a.searchKeyword=e),placeholder:"搜索活动",style:{width:"300px"},onKeyup:P(a.handleSearch,["enter"])},{append:l(()=>[o(i,{onClick:a.handleSearch},{default:l(()=>[o(p,null,{default:l(()=>[o(C)]),_:1})]),_:1},8,["onClick"])]),_:1},8,["modelValue","onKeyup"])])]),o(b,{modelValue:a.activeName,"onUpdate:modelValue":t[1]||(t[1]=e=>a.activeName=e),onTabClick:a.handleTabClick},{default:l(()=>[o(y,{label:"全部活动",name:"all"}),o(y,{label:"我报名的",name:"enrolled"})]),_:1},8,["modelValue","onTabClick"]),o(z,{gutter:20},{default:l(()=>[(c(!0),K(U,null,q(a.displayActivities,e=>(c(),m(x,{key:e.id,span:8},{default:l(()=>[o(V,{class:"activity-card",shadow:"hover"},{default:l(()=>[s("img",{src:e.coverImage||"https://via.placeholder.com/300x150",class:"activity-image"},null,8,se),s("div",ie,[s("h3",ce,g(e.title),1),s("p",re,[o(p,null,{default:l(()=>[o(D)]),_:1}),r(" "+g(a.formatDate(e.startTime))+" - "+g(a.formatDate(e.endTime)),1)]),s("p",de,[o(p,null,{default:l(()=>[o(T)]),_:1}),r(" "+g(e.location),1)]),s("p",ue,g(e.description),1),s("div",_e,[e.status===1?(c(),m(k,{key:0,type:"success"},{default:l(()=>t[3]||(t[3]=[r(" 报名中 ")])),_:1})):e.status===2?(c(),m(k,{key:1,type:"warning"},{default:l(()=>t[4]||(t[4]=[r(" 进行中 ")])),_:1})):e.status===3?(c(),m(k,{key:2,type:"info"},{default:l(()=>t[5]||(t[5]=[r(" 已结束 ")])),_:1})):E("",!0),s("div",pe,[o(i,{size:"small",type:"primary",onClick:A=>a.viewActivityDetail(e.id)},{default:l(()=>t[6]||(t[6]=[r(" 查看详情 ")])),_:2},1032,["onClick"]),!e.enrolled&&e.status===1?(c(),m(i,{key:0,size:"small",type:"success",onClick:A=>a.joinActivity(e.id)},{default:l(()=>t[7]||(t[7]=[r(" 报名 ")])),_:2},1032,["onClick"])):E("",!0),e.enrolled&&e.status===1?(c(),m(i,{key:1,size:"small",type:"danger",onClick:A=>a.cancelJoin(e.id)},{default:l(()=>t[8]||(t[8]=[r(" 取消报名 ")])),_:2},1032,["onClick"])):E("",!0)])])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),s("div",me,[o(n,{"current-page":a.currentPage,"page-size":a.pageSize,total:a.total,background:"",layout:"prev, pager, next",onCurrentChange:a.handleCurrentChange},null,8,["current-page","page-size","total","onCurrentChange"])])])}const ke=N(ne,[["render",ve],["__scopeId","data-v-97312c37"]]);export{ke as default};
