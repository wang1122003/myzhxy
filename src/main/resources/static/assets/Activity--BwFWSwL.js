import{_ as I,D as L,aM as N,J as b,aN as A,G as D,d as E,e as o,f as k,y as H,w as s,h as e,H as R,z as r,A as l,K as S,F as d,v as T,x as V,g as j,ad as z,u as F,r as m,o as J,P as y,af as P}from"./index-gQMZQ2sp.js";/* empty css                   *//* empty css                   *//* empty css               */import{b as G,c as K,j as q}from"./activity-CAs7x_u7.js";import"./request-DfavLRg_.js";import"./api-endpoints-Ctc2JoQP.js";const O={name:"ActivityDetail",components:{ElEmpty:D,ElPageHeader:A,ElDivider:b,ElImage:N,ElTag:L},setup(){const C=z(),i=F(),_=m(!0),t=m(!1),g=m(!1),u=m(null),v=m(C.params.id),c=async()=>{_.value=!0;try{const a=await G(v.value);u.value=a.data}catch(a){console.error("获取活动详情失败",a),y.error("获取活动详情失败"),u.value=null}finally{_.value=!1}},f=async()=>{t.value=!0;try{await q(v.value),y.success("报名成功"),await c()}catch(a){console.error("报名失败",a),y.error("报名失败，请稍后再试")}finally{t.value=!1}},w=async()=>{P.confirm("确定要取消报名吗？","提示",{type:"warning"}).then(async()=>{g.value=!0;try{await K(v.value),y.success("取消报名成功"),await c()}catch(a){console.error("取消报名失败",a),y.error("取消报名失败，请稍后再试")}finally{g.value=!1}}).catch(()=>{y.info("操作已取消")})},p=a=>{if(!a)return"";try{return new Date(a).toLocaleString("zh-CN",{hour12:!1})}catch{return a}},h={1:{name:"报名中",type:"success"},2:{name:"进行中",type:"warning"},3:{name:"已结束",type:"info"}},x=a=>{var n;return((n=h[a])==null?void 0:n.name)||"未知状态"},B=a=>{var n;return((n=h[a])==null?void 0:n.type)||"info"},M=()=>{i.back()};return J(()=>{c()}),{loading:_,registerLoading:t,cancelLoading:g,activity:u,handleRegister:f,handleCancel:w,formatTime:p,getStatusName:x,getStatusType:B,goBack:M}}},Q={class:"activity-detail"},U={class:"activity-header"},W={class:"activity-meta"},X={class:"activity-status"},Y={class:"activity-body"},Z=["innerHTML"],$={class:"activity-footer"},tt={key:2,class:"info-text"};function at(C,i,_,t,g,u){const v=A,c=L,f=b,w=N,p=V,h=D,x=j,B=R;return o(),E("div",Q,[k(v,{title:"返回列表",onBack:t.goBack},{content:s(()=>i[0]||(i[0]=[e("span",{class:"text-large font-600 mr-3"}," 活动详情 ",-1)])),_:1},8,["onBack"]),H((o(),r(x,{class:"activity-content"},{default:s(()=>[t.activity?(o(),E(S,{key:0},[e("div",U,[e("h2",null,d(t.activity.title),1),e("div",W,[e("span",null,"发布时间: "+d(t.formatTime(t.activity.publishTime)),1),e("span",null,"活动时间: "+d(t.formatTime(t.activity.startTime))+" - "+d(t.formatTime(t.activity.endTime)),1),e("span",null,"活动地点: "+d(t.activity.location),1)]),e("div",X,[k(c,{type:t.getStatusType(t.activity.status)},{default:s(()=>[T(d(t.getStatusName(t.activity.status)),1)]),_:1},8,["type"]),t.activity.enrolled?(o(),r(c,{key:0,style:{"margin-left":"10px"},type:"success"},{default:s(()=>i[1]||(i[1]=[T(" 已报名 ")])),_:1})):l("",!0)])]),k(f),e("div",Y,[t.activity.coverImage?(o(),r(w,{key:0,src:t.activity.coverImage,fit:"cover",style:{width:"100%",height:"300px","margin-bottom":"20px"}},null,8,["src"])):l("",!0),e("div",{class:"activity-description",innerHTML:t.activity.description},null,8,Z)]),k(f),e("div",$,[t.activity.status===1&&!t.activity.enrolled?(o(),r(p,{key:0,loading:t.registerLoading,type:"primary",onClick:t.handleRegister},{default:s(()=>i[2]||(i[2]=[T(" 报名参加 ")])),_:1},8,["loading","onClick"])):l("",!0),t.activity.status===1&&t.activity.enrolled?(o(),r(p,{key:1,loading:t.cancelLoading,type:"danger",onClick:t.handleCancel},{default:s(()=>i[3]||(i[3]=[T(" 取消报名 ")])),_:1},8,["loading","onClick"])):l("",!0),t.activity.status!==1?(o(),E("span",tt,"活动已开始或已结束，无法报名/取消报名")):l("",!0)])],64)):t.loading?l("",!0):(o(),r(h,{key:1,description:"活动不存在或已被删除"}))]),_:1})),[[B,t.loading]])])}const lt=I(O,[["render",at],["__scopeId","data-v-a8b21f13"]]);export{lt as default};
