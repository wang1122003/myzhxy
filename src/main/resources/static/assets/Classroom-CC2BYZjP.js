import{_ as Y,r as i,a as L,o as J,d as K,e as O,f as l,w as o,y as Q,z as B,A as W,m as e,i as D,j as n,k as V,T as M,U as r,x as E,V as X,v as p,B as Z,C as v,F as _,D as ee,aL as le,aM as ae,G as te,H as oe,a2 as se,h as T,aN as ue,g as re,aP as ne,aw as de,ax as I,N as ie,P as b,af as pe}from"./index-D-KotFfR.js";import{g as me,d as ve,u as fe,a as ge}from"./classroom-DTme6bOx.js";import"./request-D0VF7A5d.js";const ce={class:"classroom-management"},Ee={class:"header"},be={class:"dialog-footer"},ye={name:"ClassroomManagement"},Ve=Object.assign(ye,{setup(Ce){const A=i(!1),w=i(!1),U=i([]),N=i(0),y=i(1),C=i(10),d=L({name:"",building:"",type:"",status:""}),f=i(!1),g=i(!1),u=i({}),R=i(null),S=L({name:[{required:!0,message:"请输入教室名称",trigger:"blur"}],building:[{required:!0,message:"请输入教学楼名称",trigger:"blur"}],type:[{required:!0,message:"请选择教室类型",trigger:"change"}],capacity:[{required:!0,message:"请输入容量",trigger:"blur"},{type:"number",message:"容量必须为数字值"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),c=async()=>{A.value=!0;try{const s={page:y.value,size:C.value,...d},a=await me(s);U.value=a.data.records||[],N.value=a.data.total||0}catch(s){console.error("获取教室列表失败:",s),b.error("获取教室列表时发生错误")}finally{A.value=!1}},k=s=>({REGULAR:"普通教室",COMPUTER_LAB:"机房",LABORATORY:"实验室",MEETING_ROOM:"会议室",OTHER:"其他"})[s]||s,x=s=>({AVAILABLE:"可用",UNDER_MAINTENANCE:"维修中",DECOMMISSIONED:"停用"})[s]||s,z=s=>({AVAILABLE:"success",UNDER_MAINTENANCE:"warning",DECOMMISSIONED:"danger"})[s]||"info",h=s=>{C.value=s,y.value=1,c()},P=s=>{y.value=s,c()},G=()=>{g.value=!1,u.value={status:"AVAILABLE"},f.value=!0},F=s=>{g.value=!0,u.value={...s},f.value=!0},q=s=>{pe.confirm(`确定要删除教室 "${s.name}" 吗?`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{var a,m;try{await ve(s.id),b.success("删除成功"),c()}catch(t){console.error("删除教室失败:",t),b.error(((m=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:m.message)||"删除失败")}}).catch(()=>{})},H=()=>{var s;(s=R.value)==null||s.resetFields(),u.value={}},$=async()=>{var s,a,m;try{if(!await((s=R.value)==null?void 0:s.validate()))return;w.value=!0,g.value?(await fe(u.value.id,u.value),b.success("更新成功")):(await ge(u.value),b.success("添加成功")),f.value=!1,c()}catch(t){console.error("提交教室失败:",t),b.error(((m=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:m.message)||(g.value?"更新失败":"添加失败"))}finally{w.value=!1}};return J(()=>{c()}),(s,a)=>{const m=oe;return O(),K("div",ce,[l(e(re),{class:"page-container"},{header:o(()=>[T("div",Ee,[a[15]||(a[15]=T("span",null,"教室管理",-1)),l(e(E),{icon:e(ue),type:"primary",onClick:G},{default:o(()=>a[14]||(a[14]=[p("添加教室")])),_:1},8,["icon"])])]),default:o(()=>[l(e(D),{inline:!0,model:d,class:"filter-form"},{default:o(()=>[l(e(n),{label:"教室名称"},{default:o(()=>[l(e(V),{modelValue:d.name,"onUpdate:modelValue":a[0]||(a[0]=t=>d.name=t),clearable:"",placeholder:"请输入教室名称"},null,8,["modelValue"])]),_:1}),l(e(n),{label:"教学楼"},{default:o(()=>[l(e(V),{modelValue:d.building,"onUpdate:modelValue":a[1]||(a[1]=t=>d.building=t),clearable:"",placeholder:"请输入教学楼名称"},null,8,["modelValue"])]),_:1}),l(e(n),{label:"类型"},{default:o(()=>[l(e(M),{modelValue:d.type,"onUpdate:modelValue":a[2]||(a[2]=t=>d.type=t),clearable:"",placeholder:"请选择教室类型"},{default:o(()=>[l(e(r),{label:"全部",value:""}),l(e(r),{label:"普通教室",value:"REGULAR"}),l(e(r),{label:"机房",value:"COMPUTER_LAB"}),l(e(r),{label:"实验室",value:"LABORATORY"}),l(e(r),{label:"会议室",value:"MEETING_ROOM"}),l(e(r),{label:"其他",value:"OTHER"})]),_:1},8,["modelValue"])]),_:1}),l(e(n),{label:"状态"},{default:o(()=>[l(e(M),{modelValue:d.status,"onUpdate:modelValue":a[3]||(a[3]=t=>d.status=t),clearable:"",placeholder:"请选择状态"},{default:o(()=>[l(e(r),{label:"全部",value:""}),l(e(r),{label:"可用",value:"AVAILABLE"}),l(e(r),{label:"维修中",value:"UNDER_MAINTENANCE"}),l(e(r),{label:"停用",value:"DECOMMISSIONED"})]),_:1},8,["modelValue"])]),_:1}),l(e(n),null,{default:o(()=>[l(e(E),{icon:e(X),type:"primary",onClick:c},{default:o(()=>a[16]||(a[16]=[p("查询")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),Q((O(),B(e(Z),{data:U.value,style:{width:"100%"}},{empty:o(()=>[l(e(te),{description:"暂无教室数据"})]),default:o(()=>[l(e(v),{label:"教室名称","min-width":"150",prop:"name"}),l(e(v),{label:"教学楼",prop:"building",width:"120"}),l(e(v),{label:"类型",prop:"type",width:"120"},{default:o(t=>[p(_(k(t.row.type)),1)]),_:1}),l(e(v),{label:"容量",prop:"capacity",width:"80"}),l(e(v),{label:"设施","min-width":"180",prop:"facilities","show-overflow-tooltip":""}),l(e(v),{label:"状态",prop:"status",width:"100"},{default:o(t=>[l(e(ee),{type:z(t.row.status)},{default:o(()=>[p(_(x(t.row.status)),1)]),_:2},1032,["type"])]),_:1}),l(e(v),{fixed:"right",label:"操作",width:"150"},{default:o(t=>[l(e(E),{icon:e(le),circle:"",size:"small",type:"primary",onClick:j=>F(t.row)},null,8,["icon","onClick"]),l(e(E),{icon:e(ae),circle:"",size:"small",type:"danger",onClick:j=>q(t.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[m,A.value]]),N.value>0?(O(),B(e(se),{key:0,"current-page":y.value,"onUpdate:currentPage":a[4]||(a[4]=t=>y.value=t),"page-size":C.value,"onUpdate:pageSize":a[5]||(a[5]=t=>C.value=t),"page-sizes":[10,20,50],total:N.value,class:"pagination-container",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:h,onCurrentChange:P},null,8,["current-page","page-size","total"])):W("",!0)]),_:1}),l(e(ie),{modelValue:f.value,"onUpdate:modelValue":a[13]||(a[13]=t=>f.value=t),"close-on-click-modal":!1,title:g.value?"编辑教室":"添加教室",width:"600px",onClose:H},{footer:o(()=>[T("span",be,[l(e(E),{onClick:a[12]||(a[12]=t=>f.value=!1)},{default:o(()=>a[20]||(a[20]=[p("取消")])),_:1}),l(e(E),{loading:w.value,type:"primary",onClick:$},{default:o(()=>[p(_(g.value?"保存":"创建"),1)]),_:1},8,["loading"])])]),default:o(()=>[l(e(D),{ref_key:"classroomFormRef",ref:R,model:u.value,rules:S,"label-width":"100px"},{default:o(()=>[l(e(n),{label:"教室名称",prop:"name"},{default:o(()=>[l(e(V),{modelValue:u.value.name,"onUpdate:modelValue":a[6]||(a[6]=t=>u.value.name=t),placeholder:"请输入教室名称"},null,8,["modelValue"])]),_:1}),l(e(n),{label:"教学楼",prop:"building"},{default:o(()=>[l(e(V),{modelValue:u.value.building,"onUpdate:modelValue":a[7]||(a[7]=t=>u.value.building=t),placeholder:"请输入教学楼名称"},null,8,["modelValue"])]),_:1}),l(e(n),{label:"类型",prop:"type"},{default:o(()=>[l(e(M),{modelValue:u.value.type,"onUpdate:modelValue":a[8]||(a[8]=t=>u.value.type=t),placeholder:"请选择教室类型",style:{width:"100%"}},{default:o(()=>[l(e(r),{label:"普通教室",value:"REGULAR"}),l(e(r),{label:"机房",value:"COMPUTER_LAB"}),l(e(r),{label:"实验室",value:"LABORATORY"}),l(e(r),{label:"会议室",value:"MEETING_ROOM"}),l(e(r),{label:"其他",value:"OTHER"})]),_:1},8,["modelValue"])]),_:1}),l(e(n),{label:"容量",prop:"capacity"},{default:o(()=>[l(e(ne),{modelValue:u.value.capacity,"onUpdate:modelValue":a[9]||(a[9]=t=>u.value.capacity=t),min:1,placeholder:"请输入容量",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(e(n),{label:"设施",prop:"facilities"},{default:o(()=>[l(e(V),{modelValue:u.value.facilities,"onUpdate:modelValue":a[10]||(a[10]=t=>u.value.facilities=t),rows:3,placeholder:"请输入教室设施，如：投影仪、空调",type:"textarea"},null,8,["modelValue"])]),_:1}),l(e(n),{label:"状态",prop:"status"},{default:o(()=>[l(e(de),{modelValue:u.value.status,"onUpdate:modelValue":a[11]||(a[11]=t=>u.value.status=t)},{default:o(()=>[l(e(I),{label:"AVAILABLE"},{default:o(()=>a[17]||(a[17]=[p("可用")])),_:1}),l(e(I),{label:"UNDER_MAINTENANCE"},{default:o(()=>a[18]||(a[18]=[p("维修中")])),_:1}),l(e(I),{label:"DECOMMISSIONED"},{default:o(()=>a[19]||(a[19]=[p("停用")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),Re=Y(Ve,[["__scopeId","data-v-54a57d28"]]);export{Re as default};
