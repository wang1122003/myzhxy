import{_ as Q,r as n,a as S,c as W,o as X,d as B,e as _,h as x,f as l,w as o,v as d,m as a,l as Y,aT as Z,x as y,i as N,aP as ee,j as i,k as V,T as z,U as m,g as D,y as ae,A as le,z as te,B as oe,C as p,F as U,D as se,H as re,a2 as ue,aR as ne,N as de,P as c,af as ie}from"./index-gQMZQ2sp.js";/* empty css                   */import{g as me,d as pe,u as ce,a as fe}from"./classroom-CzAab-Ht.js";import"./request-DfavLRg_.js";const ge={class:"classroom-management-container"},ve={class:"page-header"},ye={key:0,class:"pagination-container"},be={class:"dialog-footer"},we=Object.assign({name:"ClassroomManagement"},{__name:"Classroom",setup(Ce){const T=n(!1),F=n([]),k=n(0),f=n(1),b=n(10),u=S({keyword:"",building:"",status:null}),g=n(!1),E=n("添加教室"),w=n(null),r=n({id:null,name:"",building:"",capacity:null,roomType:null,status:1}),P=S({name:[{required:!0,message:"请输入教室编号/名称",trigger:"blur"}],building:[{required:!0,message:"请输入教学楼",trigger:"blur"}],capacity:[{required:!0,type:"number",message:"请输入教室容量",trigger:"blur"}],roomType:[{required:!0,type:"number",message:"请选择教室类型",trigger:"change"}],status:[{required:!0,type:"number",message:"请选择教室状态",trigger:"change"}]}),q=W(()=>!!r.value.id),v=async()=>{T.value=!0;try{const s={page:f.value,size:b.value,keyword:u.keyword||null,building:u.building||null,status:u.status},e=await me(s);F.value=e.data.list||[],k.value=e.data.total||0}catch(s){console.error("获取教室列表失败",s),c.error("获取教室列表失败")}finally{T.value=!1}},M=()=>{f.value=1,v()},I=s=>{b.value=s,f.value=1,v()},R=s=>{f.value=s,v()},h=()=>{w.value&&w.value.resetFields(),r.value={id:null,name:"",building:"",capacity:null,roomType:null,status:1}},L=()=>{h(),E.value="添加教室",g.value=!0},$=s=>{h(),E.value="编辑教室",r.value={...s},g.value=!0},j=s=>{ie.confirm(`确定要删除教室 ${s.name} 吗?`,"警告",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await pe(s.id),c.success("教室删除成功"),v()}catch(e){console.error("删除教室失败",e),c.error("删除教室失败")}}).catch(()=>{c.info("已取消删除")})},A=()=>{w.value.validate(async s=>{var e,C;if(s)try{const t={...r.value};q.value?(await ce(t.id,t),c.success("教室信息更新成功")):(await fe(t),c.success("教室添加成功")),g.value=!1,await v()}catch(t){console.error("提交教室表单失败",t),c.error(((C=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:C.message)||"提交教室表单失败")}else return console.log("教室表单验证失败"),!1})},O=s=>{const e={1:"可用",0:"维修中"};return e[s]!==void 0?e[s]:"未知"},H=s=>({1:"success",0:"danger"})[s]||"info",G=s=>{if(!s)return"-";try{return new Date(s).toLocaleString("zh-CN",{hour12:!1})}catch{return s}},J=s=>{const e={1:"普通教室",2:"多媒体教室",3:"实验室"};return e[s]!==void 0?e[s]:"未知"};return X(()=>{v()}),(s,e)=>{const C=re;return _(),B("div",ge,[x("div",ve,[e[13]||(e[13]=x("h2",null,"教室管理",-1)),l(a(y),{type:"primary",onClick:L},{default:o(()=>[l(a(Y),null,{default:o(()=>[l(a(Z))]),_:1}),e[12]||(e[12]=d(" 添加教室 "))]),_:1})]),l(a(D),{class:"filter-card"},{default:o(()=>[l(a(N),{inline:!0,model:u,onSubmit:ee(M,["prevent"])},{default:o(()=>[l(a(i),{label:"关键词"},{default:o(()=>[l(a(V),{modelValue:u.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>u.keyword=t),clearable:"",placeholder:"教室编号/教学楼",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),l(a(i),{label:"教学楼"},{default:o(()=>[l(a(V),{modelValue:u.building,"onUpdate:modelValue":e[1]||(e[1]=t=>u.building=t),clearable:"",placeholder:"输入教学楼",style:{width:"150px"}},null,8,["modelValue"])]),_:1}),l(a(i),{label:"状态"},{default:o(()=>[l(a(z),{modelValue:u.status,"onUpdate:modelValue":e[2]||(e[2]=t=>u.status=t),clearable:"",placeholder:"选择状态",style:{width:"120px"}},{default:o(()=>[l(a(m),{value:1,label:"可用"}),l(a(m),{value:0,label:"维修中"})]),_:1},8,["modelValue"])]),_:1}),l(a(i),null,{default:o(()=>[l(a(y),{type:"primary",onClick:M},{default:o(()=>e[14]||(e[14]=[d(" 查询 ")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(a(D),{class:"classroom-list-card"},{default:o(()=>[ae((_(),te(a(oe),{data:F.value,style:{width:"100%"}},{default:o(()=>[l(a(p),{label:"教室编号/名称",prop:"name","min-width":"180"}),l(a(p),{label:"教学楼",prop:"building",width:"120"}),l(a(p),{label:"容量",prop:"capacity",width:"100"}),l(a(p),{label:"类型",prop:"roomType",width:"120"},{default:o(t=>[d(U(J(t.row.roomType)),1)]),_:1}),l(a(p),{label:"状态",prop:"status",width:"100"},{default:o(t=>[l(a(se),{type:H(t.row.status)},{default:o(()=>[d(U(O(t.row.status)),1)]),_:2},1032,["type"])]),_:1}),l(a(p),{label:"创建时间",prop:"createTime",width:"180"},{default:o(t=>[d(U(G(t.row.createTime)),1)]),_:1}),l(a(p),{fixed:"right",label:"操作",width:"150"},{default:o(t=>[l(a(y),{size:"small",type:"primary",onClick:K=>$(t.row)},{default:o(()=>e[15]||(e[15]=[d(" 编辑 ")])),_:2},1032,["onClick"]),l(a(y),{size:"small",type:"danger",onClick:K=>j(t.row)},{default:o(()=>e[16]||(e[16]=[d(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[C,T.value]]),k.value>0?(_(),B("div",ye,[l(a(ue),{"current-page":f.value,"onUpdate:currentPage":e[3]||(e[3]=t=>f.value=t),"page-size":b.value,"onUpdate:pageSize":e[4]||(e[4]=t=>b.value=t),"page-sizes":[10,20,50,100],total:k.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:I,onCurrentChange:R},null,8,["current-page","page-size","total"])])):le("",!0)]),_:1}),l(a(de),{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=t=>g.value=t),title:E.value,width:"600px",onClose:h},{footer:o(()=>[x("span",be,[l(a(y),{onClick:e[10]||(e[10]=t=>g.value=!1)},{default:o(()=>e[17]||(e[17]=[d("取消")])),_:1}),l(a(y),{type:"primary",onClick:A},{default:o(()=>e[18]||(e[18]=[d("确定")])),_:1})])]),default:o(()=>[l(a(N),{ref_key:"classroomFormRef",ref:w,model:r.value,rules:P,"label-width":"100px"},{default:o(()=>[l(a(i),{label:"教室编号/名称",prop:"name"},{default:o(()=>[l(a(V),{modelValue:r.value.name,"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.name=t),placeholder:"请输入教室编号/名称"},null,8,["modelValue"])]),_:1}),l(a(i),{label:"教学楼",prop:"building"},{default:o(()=>[l(a(V),{modelValue:r.value.building,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.building=t),placeholder:"请输入教学楼"},null,8,["modelValue"])]),_:1}),l(a(i),{label:"容量",prop:"capacity"},{default:o(()=>[l(a(ne),{modelValue:r.value.capacity,"onUpdate:modelValue":e[7]||(e[7]=t=>r.value.capacity=t),min:0,placeholder:"请输入教室容量"},null,8,["modelValue"])]),_:1}),l(a(i),{label:"类型",prop:"roomType"},{default:o(()=>[l(a(z),{modelValue:r.value.roomType,"onUpdate:modelValue":e[8]||(e[8]=t=>r.value.roomType=t),placeholder:"请选择教室类型"},{default:o(()=>[l(a(m),{value:1,label:"普通教室"}),l(a(m),{value:2,label:"多媒体教室"}),l(a(m),{value:3,label:"实验室"})]),_:1},8,["modelValue"])]),_:1}),l(a(i),{label:"状态",prop:"status"},{default:o(()=>[l(a(z),{modelValue:r.value.status,"onUpdate:modelValue":e[9]||(e[9]=t=>r.value.status=t),placeholder:"请选择教室状态"},{default:o(()=>[l(a(m),{value:1,label:"可用"}),l(a(m),{value:0,label:"维修中"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),he=Q(we,[["__scopeId","data-v-32fb1bfa"]]);export{he as default};
