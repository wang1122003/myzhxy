import{_ as X,r as n,a as B,c as Y,o as Z,d as x,e as V,h as I,f as a,w as r,v,m as l,l as ee,aT as le,x as g,i as D,aP as ae,j as d,T as U,K as te,L as oe,z as S,U as w,k as y,g as M,y as re,A as ue,B as se,C as b,F as de,H as ne,a2 as ie,aR as me,aU as ce,N as pe,P as m,af as ve}from"./index-gQMZQ2sp.js";/* empty css                   */import{d as fe,u as ge,c as ye,e as be}from"./course-DXTLIjhn.js";import{h as Ve}from"./user-xlhqAG_R.js";import{g as we}from"./term-BwK5SD_a.js";import"./request-DfavLRg_.js";import"./api-endpoints-Ctc2JoQP.js";const Ce={class:"course-management-container"},Ne={class:"page-header"},he={key:0,class:"pagination-container"},Te={class:"dialog-footer"},Ee={name:"CourseManagement"},ke=Object.assign(Ee,{setup(xe){const h=n(!1),z=n([]),T=n(0),c=n(1),C=n(10),s=B({keyword:"",status:null,termId:null}),f=n(!1),E=n("添加课程"),N=n(null),u=n({id:null,courseNo:"",courseName:"",credit:0,courseType:null,collegeId:null,collegeName:"",introduction:"",status:1}),P=B({courseNo:[{required:!0,message:"请输入课程代码",trigger:"blur"}],courseName:[{required:!0,message:"请输入课程名称",trigger:"blur"}],credit:[{required:!0,message:"请输入学分",trigger:"blur"},{type:"number",message:"学分必须为数字值"},{validator:(o,e,i)=>{e<0?i(new Error("学分不能为负数")):i()},trigger:"blur"}]}),_=Y(()=>!!u.value.id),R=n([]),F=n([]),p=async()=>{h.value=!0;try{const o={page:c.value,size:C.value,keyword:s.keyword||void 0,status:s.status,termId:s.termId||void 0},e=await be(o);z.value=e.data.records||[],T.value=e.data.total||0}catch(o){console.error("获取课程列表失败",o),m.error("获取课程列表失败")}finally{h.value=!1}},$=async()=>{try{const o=await Ve({userType:"Teacher"});R.value=o.data||[]}catch(o){console.error("获取教师列表失败",o)}},j=async()=>{try{const o=await we();if(o.code===200&&o.data){F.value=o.data;const e=o.data.find(i=>i.current===1);e&&!s.termId&&(s.termId=e.id,p())}else m.error(o.message||"获取学期列表失败")}catch(o){console.error("获取学期列表失败",o),m.error("获取学期列表时发生错误")}},L=()=>{c.value=1,p()},q=o=>{C.value=o,c.value=1,p()},A=o=>{c.value=o,p()},k=()=>{N.value&&N.value.resetFields(),u.value={id:null,courseNo:"",courseName:"",credit:0,courseType:null,collegeId:null,collegeName:"",introduction:"",status:1}},O=()=>{k(),E.value="添加课程",f.value=!0},H=o=>{k(),E.value="编辑课程",u.value={...o},f.value=!0},K=o=>{ve.confirm(`确定要删除课程 ${o.courseName} 吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await fe(o.id),m.success("删除成功"),p()}catch(e){console.error("删除课程失败",e),m.error("删除课程失败")}}).catch(()=>{m.info("已取消删除")})},G=()=>{N.value.validate(async o=>{if(o)try{if(_.value){const{id:e,...i}=u.value;await ge(e,i),m.success("课程信息更新成功")}else await ye(u.value),m.success("课程添加成功");f.value=!1,await p()}catch(e){console.error("提交课程表单失败",e)}else return console.log("课程表单验证失败"),!1})},J=o=>{if(!o)return"-";try{return new Date(o).toLocaleString("zh-CN",{hour12:!1})}catch{return o}},Q=()=>{c.value=1,p()};return Z(()=>{j(),$()}),(o,e)=>{const i=ne;return V(),x("div",Ce,[I("div",Ne,[e[16]||(e[16]=I("h2",null,"课程管理",-1)),a(l(g),{type:"primary",onClick:O},{default:r(()=>[a(l(ee),null,{default:r(()=>[a(l(le))]),_:1}),e[15]||(e[15]=v(" 添加课程 "))]),_:1})]),a(l(M),{class:"filter-card"},{default:r(()=>[a(l(D),{inline:!0,model:s,onSubmit:ae(L,["prevent"])},{default:r(()=>[a(l(d),{label:"学期"},{default:r(()=>[a(l(U),{modelValue:s.termId,"onUpdate:modelValue":e[0]||(e[0]=t=>s.termId=t),placeholder:"选择学期",clearable:"",filterable:"",style:{width:"200px"},onChange:Q},{default:r(()=>[(V(!0),x(te,null,oe(F.value,t=>(V(),S(l(w),{key:t.id,label:t.termName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(l(d),{label:"关键词"},{default:r(()=>[a(l(y),{modelValue:s.keyword,"onUpdate:modelValue":e[1]||(e[1]=t=>s.keyword=t),clearable:"",placeholder:"课程代码/课程名称",style:{width:"250px"}},null,8,["modelValue"])]),_:1}),a(l(d),{label:"状态"},{default:r(()=>[a(l(U),{modelValue:s.status,"onUpdate:modelValue":e[2]||(e[2]=t=>s.status=t),clearable:"",placeholder:"选择状态",style:{width:"120px"}},{default:r(()=>[a(l(w),{value:1,label:"正常"}),a(l(w),{value:0,label:"禁用"})]),_:1},8,["modelValue"])]),_:1}),a(l(d),null,{default:r(()=>[a(l(g),{type:"primary",onClick:L},{default:r(()=>e[17]||(e[17]=[v(" 查询 ")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(l(M),{class:"course-list-card"},{default:r(()=>[re((V(),S(l(se),{data:z.value,style:{width:"100%"}},{default:r(()=>[a(l(b),{label:"课程代码",prop:"courseCode",width:"150"}),a(l(b),{label:"课程名称","min-width":"200",prop:"courseName"}),a(l(b),{label:"学分",prop:"credit",width:"80"}),a(l(b),{label:"学时",prop:"hours",width:"80"}),a(l(b),{label:"创建时间",prop:"createTime",width:"180"},{default:r(t=>[v(de(J(t.row.createTime)),1)]),_:1}),a(l(b),{fixed:"right",label:"操作",width:"150"},{default:r(t=>[a(l(g),{size:"small",type:"primary",onClick:W=>H(t.row)},{default:r(()=>e[18]||(e[18]=[v(" 编辑 ")])),_:2},1032,["onClick"]),a(l(g),{size:"small",type:"danger",onClick:W=>K(t.row)},{default:r(()=>e[19]||(e[19]=[v(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[i,h.value]]),T.value>0?(V(),x("div",he,[a(l(ie),{"current-page":c.value,"onUpdate:currentPage":e[3]||(e[3]=t=>c.value=t),"page-size":C.value,"onUpdate:pageSize":e[4]||(e[4]=t=>C.value=t),"page-sizes":[10,20,50,100],total:T.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:A},null,8,["current-page","page-size","total"])])):ue("",!0)]),_:1}),a(l(pe),{modelValue:f.value,"onUpdate:modelValue":e[14]||(e[14]=t=>f.value=t),title:E.value,width:"600px",onClose:k},{footer:r(()=>[I("span",Te,[a(l(g),{onClick:e[13]||(e[13]=t=>f.value=!1)},{default:r(()=>e[20]||(e[20]=[v("取消")])),_:1}),a(l(g),{type:"primary",onClick:G},{default:r(()=>e[21]||(e[21]=[v("确定")])),_:1})])]),default:r(()=>[a(l(D),{ref_key:"courseFormRef",ref:N,model:u.value,rules:P,"label-width":"100px"},{default:r(()=>[a(l(d),{label:"课程代码",prop:"courseNo"},{default:r(()=>[a(l(y),{modelValue:u.value.courseNo,"onUpdate:modelValue":e[5]||(e[5]=t=>u.value.courseNo=t),disabled:_.value,placeholder:"请输入课程代码"},null,8,["modelValue","disabled"])]),_:1}),a(l(d),{label:"课程名称",prop:"courseName"},{default:r(()=>[a(l(y),{modelValue:u.value.courseName,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value.courseName=t),placeholder:"请输入课程名称"},null,8,["modelValue"])]),_:1}),a(l(d),{label:"学分",prop:"credit"},{default:r(()=>[a(l(me),{modelValue:u.value.credit,"onUpdate:modelValue":e[7]||(e[7]=t=>u.value.credit=t),min:0,precision:1,step:.5,placeholder:"请输入学分"},null,8,["modelValue"])]),_:1}),a(l(d),{label:"所属学院ID",prop:"collegeId"},{default:r(()=>[a(l(y),{modelValue:u.value.collegeId,"onUpdate:modelValue":e[8]||(e[8]=t=>u.value.collegeId=t),modelModifiers:{number:!0},placeholder:"请输入所属学院ID (可选)"},null,8,["modelValue"])]),_:1}),a(l(d),{label:"所属学院",prop:"collegeName"},{default:r(()=>[a(l(y),{modelValue:u.value.collegeName,"onUpdate:modelValue":e[9]||(e[9]=t=>u.value.collegeName=t),placeholder:"请输入所属学院名称 (可选)"},null,8,["modelValue"])]),_:1}),a(l(d),{label:"课程类型",prop:"courseType"},{default:r(()=>[a(l(U),{modelValue:u.value.courseType,"onUpdate:modelValue":e[10]||(e[10]=t=>u.value.courseType=t),placeholder:"选择课程类型 (可选)"},{default:r(()=>[a(l(w),{value:1,label:"必修课"}),a(l(w),{value:2,label:"选修课"})]),_:1},8,["modelValue"])]),_:1}),a(l(d),{label:"状态",prop:"status"},{default:r(()=>[a(l(ce),{modelValue:u.value.status,"onUpdate:modelValue":e[11]||(e[11]=t=>u.value.status=t),"active-value":1,"inactive-value":0,"active-text":"已开课","inactive-text":"未开课"},null,8,["modelValue"])]),_:1}),a(l(d),{label:"课程简介",prop:"introduction"},{default:r(()=>[a(l(y),{modelValue:u.value.introduction,"onUpdate:modelValue":e[12]||(e[12]=t=>u.value.introduction=t),rows:3,placeholder:"请输入课程简介(可选)",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),De=X(ke,[["__scopeId","data-v-ec9c1c78"]]);export{De as default};
