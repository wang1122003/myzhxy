import{_ as H,r as u,o as P,d as g,e as d,f as o,w as s,y as U,z as D,A as C,m as l,B as F,C as p,h as n,F as i,v,D as I,x as S,G as A,H as O,a2 as R,g as $,J as G,K as j,L as J,N as K,P as _}from"./index-DrN7HJWs.js";import{b as Y,a as q}from"./notice-CrHf94I4.js";import{b as k,f as Q}from"./formatters-COdykrJD.js";import"./request-BGbcGZqw.js";const W={class:"teacher-notice-view-container"},X=["onClick"],Z={key:0,class:"notice-details"},ee={class:"meta-info"},ae=["innerHTML"],te={key:0,class:"attachments-section"},le=["href"],se={class:"dialog-footer"},oe={__name:"TeacherNoticeView",setup(ne){const w=u(!1),h=u([]),f=u(0),m=u(1),y=u(10),c=u(!1),r=u(null),E=u(!1),T=async()=>{w.value=!0;try{const t={page:m.value,size:y.value},e=await Y(t);e.code===200&&e.data?(h.value=e.data.records||[],f.value=e.data.total||0):(_.error(e.message||"获取通知列表失败"),h.value=[],f.value=0)}catch(t){console.error("获取通知列表失败:",t),_.error("获取通知列表时发生错误"),h.value=[],f.value=0}finally{w.value=!1}},b=t=>({SCHOOL:"学校通知",COLLEGE:"学院通知",COURSE:"课程通知",SYSTEM:"系统消息"})[t]||t||"未知类型",z=t=>({DRAFT:"草稿",PUBLISHED:"已发布",ARCHIVED:"已归档"})[t]||t||"未知状态",V=t=>t==="PUBLISHED"?"success":t==="DRAFT"?"warning":"info",L=t=>{y.value=t,m.value=1,T()},B=t=>{m.value=t,T()},N=async t=>{E.value=!0,c.value=!0,r.value=null;try{const e=await q(t.id);e.code===200&&e.data?r.value=e.data:(_.error(e.message||"获取通知详情失败"),c.value=!1)}catch(e){console.error("获取通知详情失败:",e),_.error("获取通知详情失败"),c.value=!1}finally{E.value=!1}};return P(()=>{T()}),(t,e)=>{const M=O;return d(),g("div",W,[o(l($),{class:"page-container"},{header:s(()=>e[4]||(e[4]=[n("div",{class:"header"},[n("span",null,"通知公告")],-1)])),default:s(()=>[U((d(),D(l(F),{data:h.value,style:{width:"100%"}},{empty:s(()=>[o(l(A),{description:"暂无通知数据"})]),default:s(()=>[o(l(p),{label:"标题","min-width":"200",prop:"title"},{default:s(a=>[n("span",{class:"notice-title",onClick:x=>N(a.row)},i(a.row.title),9,X)]),_:1}),o(l(p),{label:"类型",prop:"noticeType",width:"120"},{default:s(a=>[v(i(b(a.row.noticeType)),1)]),_:1}),o(l(p),{label:"发布人",prop:"publisherName",width:"150"}),o(l(p),{label:"发布时间",prop:"publishTime",width:"180"},{default:s(a=>[v(i(l(k)(a.row.publishTime)),1)]),_:1}),o(l(p),{label:"状态",prop:"status",width:"100"},{default:s(a=>[o(l(I),{type:V(a.row.status)},{default:s(()=>[v(i(z(a.row.status)),1)]),_:2},1032,["type"])]),_:1}),o(l(p),{label:"操作",width:"100"},{default:s(a=>[o(l(S),{size:"small",text:"",type:"primary",onClick:x=>N(a.row)},{default:s(()=>e[5]||(e[5]=[v("查看")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[M,w.value]]),f.value>0?(d(),D(l(R),{key:0,"current-page":m.value,"onUpdate:currentPage":e[0]||(e[0]=a=>m.value=a),"page-size":y.value,"onUpdate:pageSize":e[1]||(e[1]=a=>y.value=a),"page-sizes":[10,20,50,100],total:f.value,class:"pagination-container",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:L,onCurrentChange:B},null,8,["current-page","page-size","total"])):C("",!0)]),_:1}),o(l(K),{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=a=>c.value=a),title:"通知详情",top:"5vh",width:"70%"},{footer:s(()=>[n("span",se,[o(l(S),{type:"primary",onClick:e[2]||(e[2]=a=>c.value=!1)},{default:s(()=>e[7]||(e[7]=[v("关闭")])),_:1})])]),default:s(()=>[r.value?(d(),g("div",Z,[n("h3",null,i(r.value.title),1),n("div",ee,[n("span",null,"类型: "+i(b(r.value.noticeType)),1),n("span",null,"发布人: "+i(r.value.publisherName||"系统"),1),n("span",null,"发布时间: "+i(l(k)(r.value.publishTime)),1)]),o(l(G)),n("div",{class:"notice-content",innerHTML:r.value.content},null,8,ae),r.value.attachments&&r.value.attachments.length>0?(d(),g("div",te,[e[6]||(e[6]=n("h4",null,"附件:",-1)),n("ul",null,[(d(!0),g(j,null,J(r.value.attachments,a=>(d(),g("li",{key:a.id},[n("a",{href:a.url,target:"_blank"},i(a.fileName),9,le),v(" ("+i(l(Q)(a.size))+") ",1)]))),128))])])):C("",!0)])):C("",!0)]),_:1},8,["modelValue"])])}}},ce=H(oe,[["__scopeId","data-v-c7dfe9d0"]]);export{ce as default};
