<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>活动管理 - 智慧校园服务系统</title>
    <link rel="stylesheet" href="../../../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../../../static/css/admin.css">
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <!-- 加载遮罩 -->
    <div id="loading-mask">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">加载中...</span>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <!-- 侧边栏将通过JavaScript加载 -->
            <div id="sidebar-container"></div>

            <!-- 主内容区 -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2" id="page-title">活动管理</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <button type="button" class="btn btn-sm btn-primary" id="btn-add-activity">
                            <i class="bi bi-plus-circle"></i> 添加活动
                        </button>
                    </div>
                </div>

                <!-- 搜索栏 -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="input-group">
                            <input type="text" class="form-control" id="search-input" placeholder="搜索活动名称、描述...">
                            <button class="btn btn-outline-secondary" type="button" id="btn-search">
                                <i class="bi bi-search"></i> 搜索
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="btn-group float-end" role="group">
                            <button type="button" class="btn btn-outline-secondary active" id="btn-filter-all">全部</button>
                            <button type="button" class="btn btn-outline-secondary" id="btn-filter-ongoing">进行中</button>
                            <button type="button" class="btn btn-outline-secondary" id="btn-filter-upcoming">即将开始</button>
                            <button type="button" class="btn btn-outline-secondary" id="btn-filter-ended">已结束</button>
                        </div>
                    </div>
                </div>

                <!-- 活动列表 -->
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">活动名称</th>
                                <th scope="col">活动类型</th>
                                <th scope="col">开始时间</th>
                                <th scope="col">结束时间</th>
                                <th scope="col">地点</th>
                                <th scope="col">状态</th>
                                <th scope="col">操作</th>
                            </tr>
                        </thead>
                        <tbody id="activity-list">
                            <!-- 活动数据将通过JavaScript动态加载 -->
                        </tbody>
                    </table>
                </div>

                <!-- 分页 -->
                <nav aria-label="Page navigation" class="mt-3">
                    <ul class="pagination justify-content-center" id="pagination">
                        <!-- 分页按钮将通过JavaScript动态加载 -->
                    </ul>
                </nav>
            </main>
        </div>
    </div>

    <!-- 添加/编辑活动模态框 -->
    <div class="modal fade" id="activityModal" tabindex="-1" aria-labelledby="activityModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="activityModalLabel">添加活动</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="activity-form">
                        <input type="hidden" id="activity-id">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="activity-name" class="form-label">活动名称</label>
                                <input type="text" class="form-control" id="activity-name" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="activity-type" class="form-label">活动类型</label>
                                <select class="form-select" id="activity-type" required>
                                    <option value="1">学术讲座</option>
                                    <option value="2">文化活动</option>
                                    <option value="3">体育活动</option>
                                    <option value="4">社团活动</option>
                                    <option value="5">志愿服务</option>
                                    <option value="6">其他活动</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="start-time" class="form-label">开始时间</label>
                                <input type="datetime-local" class="form-control" id="start-time" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="end-time" class="form-label">结束时间</label>
                                <input type="datetime-local" class="form-control" id="end-time" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="location" class="form-label">活动地点</label>
                            <input type="text" class="form-control" id="location" required>
                        </div>
                        <div class="mb-3">
                            <label for="organizer" class="form-label">主办方</label>
                            <input type="text" class="form-control" id="organizer" required>
                        </div>
                        <div class="mb-3">
                            <label for="max-participants" class="form-label">最大参与人数</label>
                            <input type="number" class="form-control" id="max-participants" min="1" required>
                        </div>
                        <div class="mb-3">
                            <label for="description" class="form-label">活动描述</label>
                            <textarea class="form-control" id="description" rows="4" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="requirements" class="form-label">参与要求</label>
                            <textarea class="form-control" id="requirements" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="status" class="form-label">状态</label>
                            <select class="form-select" id="status" required>
                                <option value="0">未开始</option>
                                <option value="1">进行中</option>
                                <option value="2">已结束</option>
                                <option value="3">已取消</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="btn-save-activity">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 确认删除模态框 -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel">确认删除</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>确定要删除此活动吗？此操作不可恢复。</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-danger" id="btn-confirm-delete">删除</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 查看参与者模态框 -->
    <div class="modal fade" id="participantsModal" tabindex="-1" aria-labelledby="participantsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="participantsModalLabel">活动参与者</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">学号/工号</th>
                                    <th scope="col">姓名</th>
                                    <th scope="col">角色</th>
                                    <th scope="col">报名时间</th>
                                    <th scope="col">状态</th>
                                    <th scope="col">操作</th>
                                </tr>
                            </thead>
                            <tbody id="participants-list">
                                <!-- 参与者数据将通过JavaScript动态加载 -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 脚本 -->
    <script src="../../../static/js/jquery.min.js"></script>
    <script src="../../../static/js/bootstrap.bundle.min.js"></script>
    <script src="../../../static/js/api.js"></script>
    <script src="../../../static/js/ui.js"></script>
    <script>
        // 当前页码和每页显示数量
        let currentPage = 1;
        const pageSize = 10;
        let totalPages = 1;
        let currentFilter = 'all';
        let currentKeyword = '';
        let activityToDelete = null; // 当前待删除的活动ID
        let currentActivityId = null; // 当前查看参与者的活动ID

        // 页面加载完成后执行
        $(document).ready(function() {
            // 加载侧边栏
            $('#sidebar-container').load('../../sidebar.html', function() {
                // 设置当前页面的导航项为激活状态
                $('.nav-link[href*="modules/activity/index.html"]').addClass('active');
            });
            
            // 检查登录状态
            checkLogin();
            
            // 加载活动列表
            loadActivityList();
            
            // 绑定事件处理器
            bindEventHandlers();
        });
        
        // 检查用户是否已登录
        function checkLogin() {
            API.checkToken(function(success) {
                if (!success) {
                    // 未登录，跳转到登录页
                    window.location.href = '../../../index.html';
                } else {
                    // 检查权限
                    API.checkPermission('activity_manage', function(hasPermission) {
                        if (!hasPermission) {
                            alert('您没有活动管理权限');
                            window.location.href = '../../index.html';
                        } else {
                            // 已登录且有权限，显示内容
                            $('#loading-mask').hide();
                        }
                    });
                }
            });
        }
        
        // 绑定各种事件处理器
        function bindEventHandlers() {
            // 添加活动按钮
            $('#btn-add-activity').on('click', function() {
                openActivityModal();
            });
            
            // 保存活动按钮
            $('#btn-save-activity').on('click', function() {
                saveActivity();
            });
            
            // 搜索按钮
            $('#btn-search').on('click', function() {
                currentKeyword = $('#search-input').val().trim();
                currentPage = 1;
                loadActivityList();
            });
            
            // 回车键搜索
            $('#search-input').on('keypress', function(e) {
                if (e.which === 13) {
                    $('#btn-search').click();
                }
            });
            
            // 筛选按钮
            $('#btn-filter-all').on('click', function() {
                currentFilter = 'all';
                updateFilterButtons();
                currentPage = 1;
                loadActivityList();
            });
            
            $('#btn-filter-ongoing').on('click', function() {
                currentFilter = 'ongoing';
                updateFilterButtons();
                currentPage = 1;
                loadActivityList();
            });
            
            $('#btn-filter-upcoming').on('click', function() {
                currentFilter = 'upcoming';
                updateFilterButtons();
                currentPage = 1;
                loadActivityList();
            });
            
            $('#btn-filter-ended').on('click', function() {
                currentFilter = 'ended';
                updateFilterButtons();
                currentPage = 1;
                loadActivityList();
            });
            
            // 确认删除按钮
            $('#btn-confirm-delete').on('click', function() {
                if (activityToDelete) {
                    deleteActivity(activityToDelete);
                }
            });
        }
        
        // 更新筛选按钮状态
        function updateFilterButtons() {
            $('.btn-group .btn').removeClass('active');
            switch (currentFilter) {
                case 'ongoing':
                    $('#btn-filter-ongoing').addClass('active');
                    break;
                case 'upcoming':
                    $('#btn-filter-upcoming').addClass('active');
                    break;
                case 'ended':
                    $('#btn-filter-ended').addClass('active');
                    break;
                default:
                    $('#btn-filter-all').addClass('active');
                    break;
            }
        }
        
        // 加载活动列表
        function loadActivityList() {
            $('#loading-mask').show();
            
            // 根据筛选条件设置活动状态
            let status = null;
            if (currentFilter === 'ongoing') {
                status = 1;
            } else if (currentFilter === 'upcoming') {
                status = 0;
            } else if (currentFilter === 'ended') {
                status = 2;
            }
            
            API.getActivityList(currentPage, pageSize, currentKeyword, status, function(result) {
                $('#loading-mask').hide();
                
                if (result.success) {
                    // 渲染活动列表
                    renderActivityList(result.data.activities);
                    
                    // 更新分页
                    totalPages = Math.ceil(result.data.total / pageSize);
                    renderPagination();
                } else {
                    UI.showError('加载活动列表失败：' + result.message);
                }
            });
        }
        
        // 渲染活动列表
        function renderActivityList(activities) {
            const $activityList = $('#activity-list');
            $activityList.empty();
            
            if (activities.length === 0) {
                $activityList.append('<tr><td colspan="8" class="text-center">没有找到匹配的活动</td></tr>');
                return;
            }
            
            activities.forEach(function(activity, index) {
                const activityTypeText = getActivityTypeText(activity.activityType);
                const statusText = getActivityStatusText(activity.status);
                
                const row = `
                    <tr>
                        <td>${(currentPage - 1) * pageSize + index + 1}</td>
                        <td>${activity.activityName}</td>
                        <td>${activityTypeText}</td>
                        <td>${formatDateTime(activity.startTime)}</td>
                        <td>${formatDateTime(activity.endTime)}</td>
                        <td>${activity.location}</td>
                        <td>${statusText}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-info btn-participants" data-id="${activity.id}">
                                <i class="bi bi-people"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-primary btn-edit" data-id="${activity.id}">
                                <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger btn-delete" data-id="${activity.id}">
                                <i class="bi bi-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                
                $activityList.append(row);
            });
            
            // 编辑按钮点击事件
            $('.btn-edit').on('click', function() {
                const activityId = $(this).data('id');
                openActivityModal(activityId);
            });
            
            // 删除按钮点击事件
            $('.btn-delete').on('click', function() {
                const activityId = $(this).data('id');
                activityToDelete = activityId;
                $('#deleteModal').modal('show');
            });
            
            // 查看参与者按钮点击事件
            $('.btn-participants').on('click', function() {
                const activityId = $(this).data('id');
                openParticipantsModal(activityId);
            });
        }
        
        // 渲染分页
        function renderPagination() {
            const $pagination = $('#pagination');
            $pagination.empty();
            
            if (totalPages <= 1) {
                return;
            }
            
            // 上一页
            $pagination.append(`
                <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                    <a class="page-link" href="#" data-page="${currentPage - 1}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
            `);
            
            // 页码
            for (let i = 1; i <= totalPages; i++) {
                if (i === currentPage) {
                    $pagination.append(`
                        <li class="page-item active"><a class="page-link" href="#" data-page="${i}">${i}</a></li>
                    `);
                } else {
                    // 只显示当前页附近的页码
                    if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                        $pagination.append(`
                            <li class="page-item"><a class="page-link" href="#" data-page="${i}">${i}</a></li>
                        `);
                    } else if (i === currentPage - 3 || i === currentPage + 3) {
                        $pagination.append(`
                            <li class="page-item disabled"><a class="page-link" href="#">...</a></li>
                        `);
                    }
                }
            }
            
            // 下一页
            $pagination.append(`
                <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                    <a class="page-link" href="#" data-page="${currentPage + 1}" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            `);
            
            // 页码点击事件
            $('.page-link').on('click', function(e) {
                e.preventDefault();
                const page = $(this).data('page');
                if (page && page !== currentPage && page > 0 && page <= totalPages) {
                    currentPage = page;
                    loadActivityList();
                }
            });
        }
        
        // 打开活动模态框
        function openActivityModal(activityId) {
            // 重置表单
            $('#activity-form')[0].reset();
            $('#activity-id').val('');
            
            if (activityId) {
                // 编辑活动
                $('#activityModalLabel').text('编辑活动');
                
                // 加载活动信息
                $('#loading-mask').show();
                API.getActivityById(activityId, function(result) {
                    $('#loading-mask').hide();
                    
                    if (result.success) {
                        const activity = result.data;
                        $('#activity-id').val(activity.id);
                        $('#activity-name').val(activity.activityName);
                        $('#activity-type').val(activity.activityType);
                        $('#start-time').val(formatDateTimeForInput(activity.startTime));
                        $('#end-time').val(formatDateTimeForInput(activity.endTime));
                        $('#location').val(activity.location);
                        $('#organizer').val(activity.organizer);
                        $('#max-participants').val(activity.maxParticipants);
                        $('#description').val(activity.description);
                        $('#requirements').val(activity.requirements);
                        $('#status').val(activity.status);
                        
                        $('#activityModal').modal('show');
                    } else {
                        UI.showError('加载活动信息失败：' + result.message);
                    }
                });
            } else {
                // 添加活动
                $('#activityModalLabel').text('添加活动');
                $('#activityModal').modal('show');
            }
        }
        
        // 保存活动
        function saveActivity() {
            const activityId = $('#activity-id').val();
            const activityName = $('#activity-name').val();
            const activityType = $('#activity-type').val();
            const startTime = $('#start-time').val();
            const endTime = $('#end-time').val();
            const location = $('#location').val();
            const organizer = $('#organizer').val();
            const maxParticipants = $('#max-participants').val();
            const description = $('#description').val();
            const requirements = $('#requirements').val();
            const status = $('#status').val();
            
            // 表单验证
            if (!activityName || !activityType || !startTime || !endTime || !location || !organizer || !maxParticipants || !description) {
                UI.showError('请填写必填字段');
                return;
            }
            
            if (new Date(startTime) >= new Date(endTime)) {
                UI.showError('开始时间必须早于结束时间');
                return;
            }
            
            const activityData = {
                activityName: activityName,
                activityType: parseInt(activityType),
                startTime: startTime,
                endTime: endTime,
                location: location,
                organizer: organizer,
                maxParticipants: parseInt(maxParticipants),
                description: description,
                requirements: requirements,
                status: parseInt(status)
            };
            
            $('#loading-mask').show();
            
            if (activityId) {
                // 编辑活动
                activityData.id = parseInt(activityId);
                API.updateActivity(activityData, function(result) {
                    $('#loading-mask').hide();
                    
                    if (result.success) {
                        $('#activityModal').modal('hide');
                        UI.showSuccess('活动更新成功');
                        loadActivityList();
                    } else {
                        UI.showError('活动更新失败：' + result.message);
                    }
                });
            } else {
                // 添加活动
                API.addActivity(activityData, function(result) {
                    $('#loading-mask').hide();
                    
                    if (result.success) {
                        $('#activityModal').modal('hide');
                        UI.showSuccess('活动添加成功');
                        loadActivityList();
                    } else {
                        UI.showError('活动添加失败：' + result.message);
                    }
                });
            }
        }
        
        // 删除活动
        function deleteActivity(activityId) {
            $('#loading-mask').show();
            
            API.deleteActivity(activityId, function(result) {
                $('#loading-mask').hide();
                $('#deleteModal').modal('hide');
                
                if (result.success) {
                    UI.showSuccess('活动删除成功');
                    loadActivityList();
                } else {
                    UI.showError('活动删除失败：' + result.message);
                }
            });
        }
        
        // 打开参与者模态框
        function openParticipantsModal(activityId) {
            currentActivityId = activityId;
            
            // 加载活动信息
            $('#loading-mask').show();
            API.getActivityById(activityId, function(result) {
                if (result.success) {
                    const activity = result.data;
                    $('#participantsModalLabel').text(`活动参与者 - ${activity.activityName}`);
                    
                    // 加载参与者列表
                    loadParticipantsList(activityId);
                } else {
                    $('#loading-mask').hide();
                    UI.showError('加载活动信息失败：' + result.message);
                }
            });
            
            $('#participantsModal').modal('show');
        }
        
        // 加载参与者列表
        function loadParticipantsList(activityId) {
            API.getActivityParticipants(activityId, function(result) {
                $('#loading-mask').hide();
                
                if (result.success) {
                    renderParticipantsList(result.data);
                } else {
                    UI.showError('加载参与者列表失败：' + result.message);
                }
            });
        }
        
        // 渲染参与者列表
        function renderParticipantsList(participants) {
            const $participantsList = $('#participants-list');
            $participantsList.empty();
            
            if (participants.length === 0) {
                $participantsList.append('<tr><td colspan="7" class="text-center">暂无参与者</td></tr>');
                return;
            }
            
            participants.forEach(function(participant, index) {
                const roleText = getRoleText(participant.role);
                const statusText = getParticipantStatusText(participant.status);
                
                const row = `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${participant.userCode}</td>
                        <td>${participant.realName}</td>
                        <td>${roleText}</td>
                        <td>${formatDateTime(participant.registerTime)}</td>
                        <td>${statusText}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-danger btn-remove-participant" data-id="${participant.id}">
                                <i class="bi bi-x-circle"></i>
                            </button>
                        </td>
                    </tr>
                `;
                
                $participantsList.append(row);
            });
            
            // 移除参与者按钮点击事件
            $('.btn-remove-participant').on('click', function() {
                const participantId = $(this).data('id');
                removeParticipant(participantId);
            });
        }
        
        // 移除参与者
        function removeParticipant(participantId) {
            if (confirm('确定要移除此参与者吗？')) {
                $('#loading-mask').show();
                
                API.removeActivityParticipant(participantId, function(result) {
                    $('#loading-mask').hide();
                    
                    if (result.success) {
                        UI.showSuccess('参与者移除成功');
                        loadParticipantsList(currentActivityId);
                    } else {
                        UI.showError('参与者移除失败：' + result.message);
                    }
                });
            }
        }
        
        // 获取活动类型文本
        function getActivityTypeText(activityType) {
            switch (parseInt(activityType)) {
                case 1: return '<span class="badge bg-primary">学术讲座</span>';
                case 2: return '<span class="badge bg-info">文化活动</span>';
                case 3: return '<span class="badge bg-success">体育活动</span>';
                case 4: return '<span class="badge bg-warning">社团活动</span>';
                case 5: return '<span class="badge bg-danger">志愿服务</span>';
                case 6: return '<span class="badge bg-secondary">其他活动</span>';
                default: return '<span class="badge bg-secondary">未知</span>';
            }
        }
        
        // 获取活动状态文本
        function getActivityStatusText(status) {
            switch (parseInt(status)) {
                case 0: return '<span class="badge bg-info">未开始</span>';
                case 1: return '<span class="badge bg-success">进行中</span>';
                case 2: return '<span class="badge bg-secondary">已结束</span>';
                case 3: return '<span class="badge bg-danger">已取消</span>';
                default: return '<span class="badge bg-secondary">未知</span>';
            }
        }
        
        // 获取角色文本
        function getRoleText(role) {
            switch (parseInt(role)) {
                case 1: return '<span class="badge bg-primary">管理员</span>';
                case 2: return '<span class="badge bg-info">教师</span>';
                case 3: return '<span class="badge bg-secondary">学生</span>';
                default: return '<span class="badge bg-secondary">未知</span>';
            }
        }
        
        // 获取参与者状态文本
        function getParticipantStatusText(status) {
            switch (parseInt(status)) {
                case 0: return '<span class="badge bg-warning">待审核</span>';
                case 1: return '<span class="badge bg-success">已通过</span>';
                case 2: return '<span class="badge bg-danger">已拒绝</span>';
                case 3: return '<span class="badge bg-info">已签到</span>';
                default: return '<span class="badge bg-secondary">未知</span>';
            }
        }
        
        // 格式化日期时间
        function formatDateTime(dateTimeStr) {
            if (!dateTimeStr) return '';
            const date = new Date(dateTimeStr);
            return date.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // 格式化日期时间为input元素的值
        function formatDateTimeForInput(dateTimeStr) {
            if (!dateTimeStr) return '';
            const date = new Date(dateTimeStr);
            return date.toISOString().slice(0, 16);
        }
    </script>
</body>
</html> 